<!DOCTYPE html>
<html>
<head>
  <title>The CSE Automatic Screenshot Tool</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.3.1/ace.js" type="text/javascript" charset="utf-8"></script>

  <style>
    .editor {
      position: relative;
      padding-top: 30px;
    }
    #filepicker {
      height: 50px;
    }
  </style>
</head>
<body>
    <input type="file" id="filepicker" name="fileList" webkitdirectory multiple /><span>upload your code below and download the screenshot by printing the page as a pdf</span>
    <div id="container"></div>

    <script type="text/javascript">
    let container = document.getElementById('container');

    document.getElementById('filepicker').addEventListener('change', function(event) {
      let files = event.target.files;

      for (let i=0; i<files.length; i++) {
        let path = files[i].webkitRelativePath;
        if (path.indexOf('.pyc') < 0 && path.indexOf('.git') < 0) {
          console.log(path);
          let reader = new FileReader();
          reader.onload = function(e) {
            let html_str = '<div id="editor'+path+'" class="editor"></div>';
            container.innerHTML += html_str;
            let editor = ace.edit('editor'+path);
            editor.setTheme("ace/theme/xcode");
            editor.getSession().setMode("ace/mode/python");
            editor.setOptions({
              maxLines: Infinity
            });
            editor.insert(reader.result);
          }
          reader.readAsText(files[i]);
        }
      };
    }, false);

  </script>
</body>
</html>
